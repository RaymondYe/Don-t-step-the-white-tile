"use strict";void function(a){function b(a){return Math.floor(Math.random()*a)}function c(a){return document.getElementById(a)}function d(){var a='<ul class="game">';n.height=n.width/4,r=n.rows;for(var b=0;b<n.total/n.cols;b++)r-=1,a+=f();return a+="</ul>"}function e(){var a="";n.height=n.width/n.cols,r=n.rows;for(var b=0;b<n.total/n.cols;b++)r-=1,a+=f();return a}function f(){var a='<li style="height:'+n.height+'px"><ul>',c=b(m.fslBall),d=b(n.cols);q&&0==r&&(d=999,q=!1);for(var e=0;e<n.cols;e++)a+=d==e?0==c?'<li style="height:'+n.height+'px" class="b2" data-t='+r+"></li>":'<li style="height:'+n.height+'px" class="b1" data-t='+r+"></li>":'<li style="height:'+n.height+'px"></li>';return a+="</ul></li>"}function g(a){a.innerHTML+=d(),a.innerHTML+=d(),c("wall").style.height=n.width+"px",h()}function h(){m.Time.innerHTML=m.timer+"'00''"}function i(){this.timer.last=Date.now();var a=1e3*m.timer-(this.timer.last-this.timer.start);if(this.running)if(a>0){var b=Math.floor(a/1e3),c=(a/10).toFixed(0).toString().substr(-2,2);m.Time.innerHTML=b+"'"+c+"''",j()}else clearInterval(m.sTime),this.stop()}function j(){c("score").innerHTML="&#215;"+o}function k(a,b,c){a.style.webkitTransition=c+"ms",a.style.webkitTransform="translate3D(0,"+b+"px,0)"}function l(){c.ajax({url:"./server/controller.php",type:"post",dataType:"json",data:{param1:"value1"}}).done(function(){console.log("success")}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}var m={timer:30,Time:c("time"),sTime:"",moveSpeed:200,fslBall:20,fsnStop:2e3},n={total:24,cols:4,width:640,height:0,rows:6},o=0,p=0;window.localStorage&&(p=localStorage.getItem("fsnBest")||0);var q,r=n.rows;a.ball=new Best.Game({onInit:function(a){var b=this;this.id=a,q=!0,n.width=screen.availWidth,g(a),j(),c("start").addEventListener("touchstart",function(){b.start()},!1),k(this.id.firstChild,0),k(this.id.lastChild,-n.height*n.rows),gameSound()},onStart:function(){$(".game-info").slideDown(300),c("start").style.display="none",this.initEvent(),this.timer.start=Date.now(),this.onRun()},moveLi:function(){this.id.removeChild(this.id.lastChild)},initEvent:function(){var a=this;this.ta=1,this.even=!0,this.total=1,this.id.addEventListener("touchstart",function(b){var c=b.target;if(c.attributes["data-t"]){var d=parseInt(c.attributes["data-t"].value||"");if(d==a.ta&&ball.running&&!ball.paused){"b1"==c.className&&(c.className="b3"),"b2"==c.className&&(c.className="b4",a.onPause()),createjs.Sound.play("tap");var f,g;a.even?(g=a.id.firstChild,f=a.id.lastChild):(f=a.id.firstChild,g=a.id.lastChild),0==d?(k(g,n.rows*n.height,m.moveSpeed),k(f,0,m.moveSpeed)):(k(g,d*n.height,m.moveSpeed),1==d?(k(f,-(n.rows-d)*n.height,0),f.innerHTML=e()):k(f,-(n.rows-d)*n.height,m.moveSpeed)),a.total%6==0&&(a.even=a.even?!1:!0),d<n.rows&&(a.ta+=1),d==n.rows-1&&(a.ta=0),a.total+=1,o+=1}}},!1)},onRun:function(){var a=this;m.sTime=setInterval(function(){i.call(a)},a.timer.step)},onPause:function(){var a=this;$("#big").removeClass("hidden").addClass("animated bounceIn").bind("touchstart",function(){$("#hand").addClass("hidden"),createjs.Sound.play("tap"),$(this).removeClass("bounceIn").addClass("shake infinite"),o+=1,j()}),this.timer.start+=m.fsnStop;setTimeout(function(){$("#big").removeClass("bounceIn infinite").addClass("hidden").unbind(),a.onRun()},m.fsnStop);clearInterval(m.sTime)},onResume:function(){this.id.innerHTML="",this.onInit(c("wall")),this.id.className="wall",o=0,this.start()},onStop:function(){var a=this;createjs.Sound.play("over"),this.id.className+=" disabled",m.Time.innerHTML="0'00''",c("modalScore").innerHTML=o;var b=c("game-end");b.style.display="block",$("#J-Simple-Mask").show(),touch.on("#close","tap",function(){b.style.display="none",$("#J-Simple-Mask").hide()}),touch.on("#J-Simple-Mask","tap",function(){$("#J-Simple-Mask").css("z-index","999"),document.getElementById("J_share-tips").style.display="none"}),touch.on("#share","tap",function(){$("#J-Simple-Mask").css("z-index","1111"),document.getElementById("J_share-tips").style.display="block"}),c("resume").addEventListener("touchend",function(){b.style.display="none",$("#J-Simple-Mask").hide(),a.resume()},!1),l()}})}(this);